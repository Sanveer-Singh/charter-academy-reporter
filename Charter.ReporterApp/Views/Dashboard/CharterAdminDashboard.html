<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Charter Reporter App - Dashboard">
    <title>Charter Admin Dashboard - Charter Reporter</title>

    <!-- Custom fonts for SB Admin 2 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

    <!-- CSS Hierarchy Implementation -->
    <link href="https://cdn.jsdelivr.net/npm/startbootstrap-sb-admin-2@4.1.4/css/sb-admin-2.min.css" rel="stylesheet">
    <link href="../../wwwroot/css/variables.css" rel="stylesheet">
    <link href="../../wwwroot/css/site.css" rel="stylesheet">
    <link href="../../wwwroot/css/modules/dashboard.css" rel="stylesheet">
</head>

<body id="page-top">
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Page Wrapper -->
    <div id="wrapper">
        <!-- Include Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="/">
                <div class="sidebar-brand-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="sidebar-brand-text mx-3">Charter Reporter</div>
            </a>
            <hr class="sidebar-divider my-0">
            <li class="nav-item active">
                <a class="nav-link" href="/dashboard">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <hr class="sidebar-divider">
            <div class="sidebar-heading">Management</div>
            <li class="nav-item">
                <a class="nav-link" href="/reports">
                    <i class="fas fa-fw fa-chart-bar"></i>
                    <span>Reports</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/admin/approvals">
                    <i class="fas fa-fw fa-user-check"></i>
                    <span>Approvals</span>
                    <span class="badge badge-danger badge-counter">3</span>
                </a>
            </li>
        </ul>

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <!-- Include Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small">Charter Admin</span>
                                <img class="img-profile rounded-circle"
                                    src="https://ui-avatars.com/api/?name=Charter+Admin&background=1e3a8a&color=fff">
                            </a>
                        </li>
                    </ul>
                </nav>

                <!-- Begin Page Content -->
                <main id="main-content" class="container-fluid">
                    <!-- Page Heading -->
                    <div class="dashboard-header">
                        <div class="d-sm-flex align-items-center justify-content-between mb-4">
                            <div>
                                <h1 class="dashboard-header__title">Charter Admin Dashboard</h1>
                                <p class="dashboard-header__subtitle">Complete overview of all enrollments, sales, and course completions</p>
                            </div>
                            <button class="btn btn-export" onclick="Dashboard.exportData()">
                                <i class="fas fa-download btn-export__icon"></i> Export Report
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filter Panel -->
                    <div class="filter-panel">
                        <div class="filter-panel__header">
                            <h2 class="filter-panel__title">Filters</h2>
                            <a href="#" class="filter-panel__reset" onclick="Dashboard.resetFilters()">Reset All</a>
                        </div>
                        <form class="filter-panel__content" id="dashboardFilters">
                            <div class="filter-group">
                                <label for="dateRange" class="filter-group__label">Date Range</label>
                                <select name="dateRange" id="dateRange" class="filter-group__control">
                                    <option value="7">Last 7 Days</option>
                                    <option value="30" selected>Last 30 Days</option>
                                    <option value="90">Last 90 Days</option>
                                    <option value="365">Last Year</option>
                                    <option value="custom">Custom Range</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="category" class="filter-group__label">Course Category</label>
                                <select name="category" id="category" class="filter-group__control">
                                    <option value="">All Categories</option>
                                    <option value="professional">Professional Development</option>
                                    <option value="technical">Technical Skills</option>
                                    <option value="compliance">Compliance Training</option>
                                    <option value="leadership">Leadership</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="status" class="filter-group__label">Status</label>
                                <select name="status" id="status" class="filter-group__control">
                                    <option value="">All Statuses</option>
                                    <option value="active">Active</option>
                                    <option value="completed">Completed</option>
                                    <option value="pending">Pending</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <button type="submit" class="btn btn-primary btn-block">
                                    <i class="fas fa-filter"></i> Apply Filters
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Metrics Row -->
                    <div class="dashboard-grid">
                        <!-- Total Enrollments -->
                        <div class="card metric-card">
                            <div class="card-body">
                                <div class="metric-card__header">
                                    <h3 class="metric-card__title">Total Enrollments</h3>
                                    <i class="fas fa-user-graduate metric-card__icon"></i>
                                </div>
                                <div class="metric-card__value">12,456</div>
                                <div class="metric-card__change metric-card__change--positive">
                                    <i class="fas fa-arrow-up metric-card__change-icon"></i>
                                    <span>15.3% from last month</span>
                                </div>
                                <div class="metric-card__period">Last 30 days</div>
                            </div>
                        </div>
                        
                        <!-- Total Sales -->
                        <div class="card metric-card metric-card--success">
                            <div class="card-body">
                                <div class="metric-card__header">
                                    <h3 class="metric-card__title">Total Sales</h3>
                                    <i class="fas fa-dollar-sign metric-card__icon"></i>
                                </div>
                                <div class="metric-card__value">R1,245,678</div>
                                <div class="metric-card__change metric-card__change--positive">
                                    <i class="fas fa-arrow-up metric-card__change-icon"></i>
                                    <span>8.7% from last month</span>
                                </div>
                                <div class="metric-card__period">Last 30 days</div>
                            </div>
                        </div>
                        
                        <!-- Completions -->
                        <div class="card metric-card metric-card--info">
                            <div class="card-body">
                                <div class="metric-card__header">
                                    <h3 class="metric-card__title">Course Completions</h3>
                                    <i class="fas fa-certificate metric-card__icon"></i>
                                </div>
                                <div class="metric-card__value">8,923</div>
                                <div class="metric-card__change metric-card__change--positive">
                                    <i class="fas fa-arrow-up metric-card__change-icon"></i>
                                    <span>22.4% from last month</span>
                                </div>
                                <div class="metric-card__period">Last 30 days</div>
                            </div>
                        </div>
                        
                        <!-- Completion Rate -->
                        <div class="card metric-card metric-card--warning">
                            <div class="card-body">
                                <div class="metric-card__header">
                                    <h3 class="metric-card__title">Completion Rate</h3>
                                    <i class="fas fa-percentage metric-card__icon"></i>
                                </div>
                                <div class="metric-card__value">71.6%</div>
                                <div class="metric-card__change metric-card__change--negative">
                                    <i class="fas fa-arrow-down metric-card__change-icon"></i>
                                    <span>2.1% from last month</span>
                                </div>
                                <div class="metric-card__period">Last 30 days</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts Row -->
                    <div class="row">
                        <!-- Enrollment Trends Chart -->
                        <div class="col-xl-8 col-lg-7">
                            <div class="chart-container">
                                <div class="chart-container__header">
                                    <h3 class="chart-container__title">Enrollment Trends</h3>
                                    <div class="chart-container__actions">
                                        <button class="chart-container__action chart-container__action--active" data-period="daily">Daily</button>
                                        <button class="chart-container__action" data-period="weekly">Weekly</button>
                                        <button class="chart-container__action" data-period="monthly">Monthly</button>
                                    </div>
                                </div>
                                <div class="chart-wrapper">
                                    <canvas id="enrollmentChart"></canvas>
                                </div>
                                <div class="chart-legend" id="enrollmentLegend"></div>
                            </div>
                        </div>
                        
                        <!-- Course Distribution Chart -->
                        <div class="col-xl-4 col-lg-5">
                            <div class="chart-container">
                                <div class="chart-container__header">
                                    <h3 class="chart-container__title">Course Distribution</h3>
                                </div>
                                <div class="chart-wrapper">
                                    <canvas id="distributionChart"></canvas>
                                </div>
                                <div class="chart-legend" id="distributionLegend"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Funnel Analysis -->
                    <div class="row">
                        <div class="col-12">
                            <div class="chart-container">
                                <div class="chart-container__header">
                                    <h3 class="chart-container__title">Conversion Funnel</h3>
                                    <p class="text-muted mb-0">From site visit to course completion</p>
                                </div>
                                <div class="funnel-chart">
                                    <div class="funnel-stage">
                                        <div class="funnel-stage__bar" style="width: 100%;">
                                            <div class="funnel-stage__content">
                                                <span class="funnel-stage__label">Site Visits</span>
                                                <span class="funnel-stage__value">45,678</span>
                                            </div>
                                        </div>
                                        <span class="funnel-stage__conversion">100%</span>
                                    </div>
                                    
                                    <div class="funnel-stage">
                                        <div class="funnel-stage__bar" style="width: 75%;">
                                            <div class="funnel-stage__content">
                                                <span class="funnel-stage__label">Product Views</span>
                                                <span class="funnel-stage__value">34,259</span>
                                            </div>
                                        </div>
                                        <span class="funnel-stage__conversion">75%</span>
                                    </div>
                                    
                                    <div class="funnel-stage">
                                        <div class="funnel-stage__bar" style="width: 45%;">
                                            <div class="funnel-stage__content">
                                                <span class="funnel-stage__label">Cart Additions</span>
                                                <span class="funnel-stage__value">20,555</span>
                                            </div>
                                        </div>
                                        <span class="funnel-stage__conversion">45%</span>
                                    </div>
                                    
                                    <div class="funnel-stage">
                                        <div class="funnel-stage__bar" style="width: 27%;">
                                            <div class="funnel-stage__content">
                                                <span class="funnel-stage__label">Purchases</span>
                                                <span class="funnel-stage__value">12,456</span>
                                            </div>
                                        </div>
                                        <span class="funnel-stage__conversion">27%</span>
                                    </div>
                                    
                                    <div class="funnel-stage">
                                        <div class="funnel-stage__bar" style="width: 20%;">
                                            <div class="funnel-stage__content">
                                                <span class="funnel-stage__label">Enrollments</span>
                                                <span class="funnel-stage__value">9,135</span>
                                            </div>
                                        </div>
                                        <span class="funnel-stage__conversion">20%</span>
                                    </div>
                                    
                                    <div class="funnel-stage">
                                        <div class="funnel-stage__bar" style="width: 15%;">
                                            <div class="funnel-stage__content">
                                                <span class="funnel-stage__label">Completions</span>
                                                <span class="funnel-stage__value">6,851</span>
                                            </div>
                                        </div>
                                        <span class="funnel-stage__conversion">15%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity Table -->
                    <div class="row">
                        <div class="col-12">
                            <div class="data-table-container">
                                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                    <h3 class="m-0 font-weight-bold text-primary">Recent Enrollments</h3>
                                    <a href="/reports" class="btn btn-sm btn-primary">View All</a>
                                </div>
                                <div class="card-body p-0">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>Student Name</th>
                                                <th>Email</th>
                                                <th>Course</th>
                                                <th>Category</th>
                                                <th>Enrolled</th>
                                                <th>Status</th>
                                                <th class="hide-mobile">Progress</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Sarah Johnson</td>
                                                <td>sarah.j@example.com</td>
                                                <td>Advanced Project Management</td>
                                                <td><span class="badge badge-info">Professional</span></td>
                                                <td>Dec 10, 2024</td>
                                                <td><span class="badge badge-success">Active</span></td>
                                                <td class="hide-mobile">
                                                    <div class="progress" style="height: 20px;">
                                                        <div class="progress-bar bg-success" role="progressbar" style="width: 75%"
                                                            aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">75%</div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Michael Chen</td>
                                                <td>m.chen@company.co.za</td>
                                                <td>Compliance Essentials 2024</td>
                                                <td><span class="badge badge-warning">Compliance</span></td>
                                                <td>Dec 10, 2024</td>
                                                <td><span class="badge badge-success">Active</span></td>
                                                <td class="hide-mobile">
                                                    <div class="progress" style="height: 20px;">
                                                        <div class="progress-bar bg-warning" role="progressbar" style="width: 45%"
                                                            aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">45%</div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Emma Williams</td>
                                                <td>emma.w@org.za</td>
                                                <td>Leadership Excellence</td>
                                                <td><span class="badge badge-primary">Leadership</span></td>
                                                <td>Dec 9, 2024</td>
                                                <td><span class="badge badge-secondary">Completed</span></td>
                                                <td class="hide-mobile">
                                                    <div class="progress" style="height: 20px;">
                                                        <div class="progress-bar bg-secondary" role="progressbar" style="width: 100%"
                                                            aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">100%</div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                <!-- /.container-fluid -->
            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; Charter Reporter App 2024</span>
                    </div>
                </div>
            </footer>
        </div>
        <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->

    <!-- Export Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exportModalLabel">Export Dashboard Report</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="exportForm">
                        <div class="form-group">
                            <label for="exportFormat">Select Format</label>
                            <select class="form-control" id="exportFormat" required>
                                <option value="">Choose format...</option>
                                <option value="csv">CSV (Comma Separated Values)</option>
                                <option value="xlsx">Excel (XLSX)</option>
                                <option value="pdf">PDF Report</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="exportData">Data to Include</label>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="includeMetrics" checked>
                                <label class="custom-control-label" for="includeMetrics">Summary Metrics</label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="includeEnrollments" checked>
                                <label class="custom-control-label" for="includeEnrollments">Enrollment Data</label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="includeSales" checked>
                                <label class="custom-control-label" for="includeSales">Sales Data</label>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="includeCompletions" checked>
                                <label class="custom-control-label" for="includeCompletions">Completion Data</label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="Dashboard.confirmExport()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/startbootstrap-sb-admin-2@4.1.4/js/sb-admin-2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="../../wwwroot/js/site.js"></script>
    <script src="../../wwwroot/js/modules/dashboard.js"></script>
    
    <script>
        // Initialize dashboard with sample data
        document.addEventListener('DOMContentLoaded', function() {
            Dashboard.init({
                role: 'Charter-Admin',
                chartData: {
                    enrollment: {
                        labels: ['Dec 4', 'Dec 5', 'Dec 6', 'Dec 7', 'Dec 8', 'Dec 9', 'Dec 10'],
                        datasets: [{
                            label: 'Enrollments',
                            data: [342, 389, 412, 376, 428, 445, 467],
                            borderColor: 'rgb(30, 58, 138)',
                            backgroundColor: 'rgba(30, 58, 138, 0.1)',
                            tension: 0.3
                        }, {
                            label: 'Completions',
                            data: [256, 278, 302, 289, 315, 328, 341],
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3
                        }]
                    },
                    distribution: {
                        labels: ['Professional', 'Technical', 'Compliance', 'Leadership', 'Other'],
                        datasets: [{
                            data: [35, 25, 20, 15, 5],
                            backgroundColor: [
                                'rgb(30, 58, 138)',
                                'rgb(59, 130, 246)',
                                'rgb(245, 158, 11)',
                                'rgb(16, 185, 129)',
                                'rgb(156, 163, 175)'
                            ]
                        }]
                    }
                }
            });
        });
    </script>
</body>
</html>